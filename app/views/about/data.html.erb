<h1>
  Your&nbsp;data&nbsp;is safe&nbsp;with&nbsp;us.
</h1>
<p class="bg-blue-200 rounded -ml-3 -mr-3 p-3 text-center">
  Here you can read about how data is stored on <%= name %>.<br />All data shown is actual data from the production database.
</p>
<h2>
  Email
</h2>
<p>
  If, for example, you use e-mail <strong><%= @email %></strong> to sign in to <%= name %>. We represent that e-mail on our servers like this:
</p>
<pre><code><%= Authentication::HashedEmail.from_cleartext(@email) %></code></pre>
<p>
  This is the combined SHA-256 and BLAKE2b. That means that your e-mail is not even persisted in a format that can be decrypted and reveal your actual e-mail.
</p>
<p>
  To show your e-mail in the browser it is stored in an encrypted cookie in your browser. This is not stored on the server.
</p>
<h2>
  Vault
</h2>
<p>
  All your data, i.e. your identifiers for relying parties, are stored in a vault.
</p>
<p>
  Here is a Base64 encoded example of vault data:
</p>
<pre><code><%= Base64.encode64 @vault_content.encrypted_personal_data %></code></pre>
<p>
  This data is encrypted with a secret key that can only be generated by knowing your password. Meaning only you can decrypt the contents. Here is an example of such a generated key:
</p>
<pre><code><%= @auth.vault_key %></code></pre>
<p>
  This key is only stored in an encrypted cookie. It is <strong>not</strong> stored on the server.
</p>
<p>
  You can use that key to decrypt the vault content cipher to this:
</p>
<pre><code><%= JSON.pretty_generate @personal_data.to_h %></code></pre>
<h2>
  Recovery
</h2>
<p>
  In order to be able to recover your account, i.e. reset password, we have to keep an encrypted version of your vault key. This is encrypted using public key encryption. It looks like this:
</p>
<pre><code><%= @vault_key_for_recovery.vault_key_cipher_base64 %></code></pre>
<p>
  As mentioned, this is encrypted using a private and public key. To decrypt, you'll need the corresponding public and private keys.
</p>
<p>
  The private key used to decrypt, is currently kept in a safe place that only I, Anders Lemke-Holstein, knows about.
</p>
<p>
  The public key, is kept in the production database.
</p>
<p>
  If you do not want your account to be recoverable, all that has to be done, is to delete that public key.
</p>
